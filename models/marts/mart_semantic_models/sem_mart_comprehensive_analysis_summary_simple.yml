version: 2

semantic_models:
  - name: comprehensive_analysis_summary_simple
    description: Simplified comprehensive summary of UFO and aviation analytics.
    model: ref('mart_comprehensive_analysis_summary_simple')
    defaults:
      agg_time_dimension: last_updated

    entities:
      - name: analysis_area
        type: primary
        expr: analysis_area   # column in the model

    dimensions:
      - name: last_updated
        type: time
        type_params:
          time_granularity: day
      - name: analysis_area_label      # renamed to avoid name/type collision
        expr: analysis_area            # same underlying column
        type: categorical
      - name: metric_name
        type: categorical
      - name: description
        type: categorical

    measures:
      - name: simple_metric_value
        agg: sum
        expr: metric_value
        create_metric: true
      - name: analysis_area_count
        agg: count
        expr: analysis_area_label      # reference the dimension name now
        create_metric: true